{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var o=Object.create;var s=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var i=a=>s(a,\"__esModule\",{value:!0});var k=(a,c)=>()=>(c||a((c={exports:{}}).exports,c),c.exports),g=(a,c)=>{i(a);for(var r in c)s(a,r,{get:c[r],enumerable:!0})},b=(a,c,r)=>{if(c&&typeof c==\"object\"||typeof c==\"function\")for(let e of p(c))!u.call(a,e)&&e!==\"default\"&&s(a,e,{get:()=>c[e],enumerable:!(r=d(c,e))||r.enumerable});return a},N=a=>b(i(s(a!=null?o(m(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var h=k((D,l)=>{l.exports=_jsx_runtime});var A={};g(A,{default:()=>S,frontmatter:()=>y});var n=N(h()),y={title:\"Spark on Kubernetes t\\u1EA1i Fossil\",authors:[\"duyet\"],date:\"2022-03-10\",tags:[\"engineering\",\"data\"],summary:\"Apache Spark \\u0111\\u01B0\\u1EE3c ch\\u1ECDn l\\xE0m c\\xF4ng ngh\\u1EC7 cho Batch layer b\\u1EDFi kh\\u1EA3 n\\u0103ng x\\u1EED l\\xFD m\\u1ED9t l\\u01B0\\u1EE3ng l\\u1EDBn data c\\xF9ng m\\u1ED9t l\\xFAc. \\u1EDE thi\\u1EBFt k\\u1EBF ban \\u0111\\u1EA7u, team data ch\\u1ECDn s\\u1EED d\\u1EE5ng Apache Spark tr\\xEAn AWS EMR do c\\xF3 s\\u1EB5n v\\xE0 tri\\u1EC3n khai nhanh ch\\xF3ng. D\\u1EA7n d\\u1EA7n, AWS EMR b\\u1ED9c l\\u1ED9 m\\u1ED9t s\\u1ED1 \\u0111i\\u1EC3m h\\u1EA1n ch\\u1EBF tr\\xEAn m\\xF4i tr\\u01B0\\u1EDDng Production. Trong b\\xE0i vi\\u1EBFt n\\xE0y, m\\xECnh s\\u1EBD n\\xF3i v\\u1EC1 t\\u1EA1i sao v\\xE0 l\\xE0m th\\u1EBF n\\xE0o team Data chuy\\u1EC3n t\\u1EEB Spark tr\\xEAn AWS EMR sang Kubernetes.\",layout:\"PostLayout\"};function v(a={}){let{wrapper:c}=a.components||{};return c?(0,n.jsx)(c,Object.assign({},a,{children:(0,n.jsx)(r,{})})):r();function r(){let e=Object.assign({p:\"p\",a:\"a\",strong:\"strong\",em:\"em\",h1:\"h1\",span:\"span\",ul:\"ul\",li:\"li\",math:\"math\",semantics:\"semantics\",mrow:\"mrow\",mn:\"mn\",mo:\"mo\",annotation:\"annotation\",code:\"code\",pre:\"pre\",div:\"div\",h2:\"h2\"},a.components),{Image:t}=e;return t||f(\"Image\",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"T\\u1EA1i \",(0,n.jsx)(e.a,{href:\"https://sites.google.com/fossil.com/fossil-vietnam/home\",children:\"Fossil\"}),`,\nc\\xF3 h\\xE0ng tr\\u0103m tri\\u1EC7u log records \\u0111\\u01B0\\u1EE3c thu th\\u1EADp m\\u1ED7i ng\\xE0y,\n\\u0111\\u01B0\\u1EE3c x\\u1EED l\\xFD v\\xE0 l\\u01B0u tr\\u1EEF trong c\\xE1c Data Warehouse b\\u1EDFi h\\u1EC7 th\\u1ED1ng `,(0,n.jsx)(e.strong,{children:\"Fossil Data Platform\"}),`.\nData Platform l\\xE0 m\\u1ED9t h\\u1EC7 th\\u1ED1ng event-driven \\u0111\\u01B0\\u1EE3c thi\\u1EBFt k\\u1EBF d\\u1EF1a tr\\xEAn Lambda Architecture\ng\\u1ED3m m\\u1ED9t near-realtime layer v\\xE0 m\\u1ED9t batch layer. Near-realtime layer cho ph\\xE9p data t\\u1EEB\nl\\xFAc \\u0111\\u1EA9y v\\xE0o h\\u1EC7 th\\u1ED1ng cho \\u0111\\u1EBFn khi xu\\u1EA5t hi\\u1EC7n \\u1EDF \\u0111\\u1EA7u cu\\u1ED1i c\\xF3 \\u0111\\u1ED9 tr\\u1EC5 t\\u1ED1i \\u0111a 15 ph\\xFAt.\nBatch layer s\\u1EBD t\\xEDnh to\\xE1n b\\u1ED9 data l\\u1EA1i m\\u1ED9t l\\u1EA7n n\\u1EEFa, v\\xE0o cu\\u1ED1i m\\u1ED7i ng\\xE0y, \\u0111\\u1EC3 \\u0111\\u1EA3m b\\u1EA3o data\n\\u0111\\u01B0\\u1EE3c ch\\xEDnh x\\xE1c v\\xE0 t\\u1ED1i \\u01B0u h\\xF3a \\u0111\\u1EC3 l\\u01B0u tr\\u1EEF l\\xE2u d\\xE0i.`]}),`\n`,(0,n.jsxs)(e.p,{children:[`H\\u1EC7 th\\u1ED1ng \\u0111\\u01B0\\u1EE3c tri\\u1EC3n khai tr\\xEAn Kubernetes Cluster bao g\\u1ED3m nhi\\u1EC1u th\\xE0nh ph\\u1EA7n.\nM\\u1ED9t s\\u1ED1 th\\xE0nh ph\\u1EA7n c\\xF3 th\\u1EC3 k\\u1EC3 \\u0111\\u1EBFn nh\\u01B0: `,(0,n.jsx)(e.em,{children:\"API Ingession\"}),\", \",(0,n.jsx)(e.a,{href:\"https://debezium.io\",children:(0,n.jsx)(e.em,{children:\"CDC\"})}),`,\n`,(0,n.jsx)(e.a,{href:\"https://docs.confluent.io/platform/current/connect/index.html\",children:(0,n.jsx)(e.em,{children:\"Kafka Connector\"})}),`,\nc\\xE1c `,(0,n.jsx)(e.em,{children:\"Parser\"}),\" v\\xE0 \",(0,n.jsx)(e.em,{children:\"Transformer\"}),` x\\u1EED l\\xFD raw data.\n`,(0,n.jsx)(e.a,{href:\"https://airflow.apache.org/\",children:(0,n.jsx)(e.strong,{children:\"Apache Airflow\"})}),\" v\\xE0 \",(0,n.jsx)(e.a,{href:\"https://spark.apache.org/\",children:(0,n.jsx)(e.strong,{children:\"Apache Spark\"})}),`\nc\\u0169ng \\u0111\\u01B0\\u1EE3c tri\\u1EC3n khai tr\\xEAn `,(0,n.jsx)(e.a,{href:\"https://kubernetes.io\",children:(0,n.jsx)(e.strong,{children:\"Kubernetes\"})}),`, qu\\u1EA3n l\\xFD b\\u1EDFi c\\xE1c\n`,(0,n.jsx)(e.a,{href:\"https://kubernetes.io/docs/concepts/extend-kubernetes/operator/\",children:\"Kubernetes Operators\"}),\".\"]}),`\n`,(0,n.jsxs)(e.p,{children:[`Apache Spark \\u0111\\u01B0\\u1EE3c ch\\u1ECDn l\\xE0m c\\xF4ng ngh\\u1EC7 cho Batch layer b\\u1EDFi kh\\u1EA3 n\\u0103ng x\\u1EED l\\xFD\nm\\u1ED9t l\\u01B0\\u1EE3ng l\\u1EDBn data c\\xF9ng m\\u1ED9t l\\xFAc. \\u1EDE thi\\u1EBFt k\\u1EBF ban \\u0111\\u1EA7u, team data ch\\u1ECDn s\\u1EED d\\u1EE5ng\nApache Spark tr\\xEAn `,(0,n.jsx)(e.strong,{children:\"AWS EMR\"}),` do c\\xF3 s\\u1EB5n v\\xE0 tri\\u1EC3n khai nhanh ch\\xF3ng.\nD\\u1EA7n d\\u1EA7n, AWS EMR b\\u1ED9c l\\u1ED9 m\\u1ED9t s\\u1ED1 \\u0111i\\u1EC3m h\\u1EA1n ch\\u1EBF tr\\xEAn m\\xF4i tr\\u01B0\\u1EDDng Production.`]}),`\n`,(0,n.jsx)(e.p,{children:`Trong b\\xE0i vi\\u1EBFt n\\xE0y, m\\xECnh s\\u1EBD n\\xF3i v\\u1EC1 t\\u1EA1i sao v\\xE0 l\\xE0m th\\u1EBF n\\xE0o team\nData chuy\\u1EC3n t\\u1EEB Spark tr\\xEAn AWS EMR sang Kubernetes.`}),`\n`,(0,n.jsxs)(\"div\",{class:\"toc\",children:[(0,n.jsx)(\"p\",{children:\"Trong b\\xE0i n\\xE0y:\"}),(0,n.jsxs)(\"ul\",{children:[(0,n.jsx)(\"li\",{children:(0,n.jsx)(\"a\",{href:\"#1-apache-spark-tr\\xEAn-aws-emr\",children:\"1. Apache Spark tr\\xEAn AWS EMR\"})}),`\n`,(0,n.jsx)(\"li\",{children:(0,n.jsx)(\"a\",{href:\"#2-spark-on-kubernetes---livy\",children:\"2. Spark on Kubernetes - Livy\"})}),(0,n.jsxs)(\"li\",{children:[(0,n.jsx)(\"a\",{href:\"#3-spark-on-kubernetes---spark-operator\",children:\"3. Spark on Kubernetes - Spark Operator\"}),(0,n.jsxs)(\"ul\",{children:[(0,n.jsx)(\"li\",{children:(0,n.jsx)(\"a\",{href:\"#31-spark-operator\",children:\"3.1. Spark Operator\"})}),`\n`,(0,n.jsx)(\"li\",{children:(0,n.jsx)(\"a\",{href:\"#32-spark-submit-worker\",children:\"3.2. Spark Submit Worker\"})}),`\n`,(0,n.jsx)(\"li\",{children:(0,n.jsx)(\"a\",{href:\"#33-spark-jobs-ui\",children:\"3.3. Spark Jobs UI\"})}),`\n`,(0,n.jsx)(\"li\",{children:(0,n.jsx)(\"a\",{href:\"#34-spark-history-server\",children:\"3.4. Spark History Server\"})})]})]}),(0,n.jsx)(\"li\",{children:(0,n.jsx)(\"a\",{href:\"#4-performance-tuning-on-kubernetes\",children:\"4. Performance Tuning on Kubernetes\"})}),`\n`,(0,n.jsx)(\"li\",{children:(0,n.jsx)(\"a\",{href:\"#5-k\\u1EBFt\",children:\"5. K\\u1EBFt\"})}),`\n`,(0,n.jsx)(\"li\",{children:(0,n.jsx)(\"a\",{href:\"#6-references\",children:\"6. References\"})})]})]}),`\n`,(0,n.jsxs)(e.h1,{id:\"1-apache-spark-tr\\xEAn-aws-emr\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#1-apache-spark-tr\\xEAn-aws-emr\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"1. Apache Spark tr\\xEAn AWS EMR\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Trong th\\u1EBF gi\\u1EDBi c\\u1EE7a Data Engineering th\\xEC \",(0,n.jsx)(e.a,{href:\"https://spark.apache.org/\",children:(0,n.jsx)(e.strong,{children:\"Apache Spark\"})}),` kh\\xF4ng c\\xF2n qu\\xE1 xa l\\u1EA1.\nSpark l\\xE0 open source v\\u1EDBi m\\u1EE5c \\u0111\\xEDch tri\\u1EC3n khai m\\u1ED9t h\\u1EC7 th\\u1ED1ng t\\xEDnh to\\xE1n in-memory v\\xE0 massively parallel.\nSpark \\u0111\\u01B0\\u1EE3c s\\u1EED d\\u1EE5ng r\\u1ED9ng r\\xE3i trong nhi\\u1EC1u l\\u0129nh v\\u1EF1c x\\u1EED l\\xFD Big Data, t\\u1EEB Data Analytics \\u0111\\u1EBFn Machine Learning.\nSpark \\u0111\\u01B0\\u1EE3c thi\\u1EBFt k\\u1EBF \\u0111\\u1EC3 c\\xF3 th\\u1EC3 ch\\u1EA1y \\u1EDF Standalone Mode c\\u0169ng nh\\u01B0 tr\\xEAn Mesos, YARN v\\xE0 Kubernetes.`]}),`\n`,(0,n.jsx)(e.p,{children:`\\u1EDE thi\\u1EBFt k\\u1EBF \\u0111\\u1EA7u ti\\xEAn, team Fossil Data Platform thi\\u1EBFt k\\u1EBF s\\u1EED d\\u1EE5ng Apache Spark\n\\u0111\\u1EC3 ch\\u1EA1y c\\xE1c Jobs c\\xF9ng v\\u1EDBi Apache Hive tr\\xEAn AWS EMR. \\u0110i\\u1EC1u n\\xE0y h\\u1EBFt s\\u1EE9c \\u0111\\u01A1n gi\\u1EA3n\ndo vi\\u1EC7c thi\\u1EBFt l\\u1EADp c\\u1EE5m AWS EMR kh\\xE1 d\\u1EC5 d\\xE0ng v\\xE0 nhanh ch\\xF3ng.\nD\\u1EA7n d\\u1EA7n sau m\\u1ED9t kho\\u1EA3ng th\\u1EDDi gian, team nh\\u1EADn ra c\\xF3 m\\u1ED9t s\\u1ED1 \\u0111i\\u1EC3m y\\u1EBFu:`}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"T\\u1EA1i th\\u1EDDi \\u0111i\\u1EC3m \\u0111\\xF3 AWS ch\\u01B0a ra m\\u1EAFt \",(0,n.jsx)(e.em,{children:\"EMR Serverless\"}),\" v\\xE0 \",(0,n.jsx)(e.em,{children:\"EMR on EKS\"}),\", vi\\u1EC7c scale th\\xEAm EC2 Node t\\u1ED1n th\\u1EDDi gian do ph\\u1EA3i bootstrap (c\\xE0i \\u0111\\u1EB7t v\\xE0 kh\\u1EDFi \\u0111\\u1ED9ng) 1 lo\\u1EA1t c\\xE1c services c\\u1EA7n thi\\u1EBFt.\"]}),`\n`,(0,n.jsx)(e.li,{children:\"Tr\\xEAn m\\u1ED7i Node s\\u1EBD t\\u1ED1n 1 ph\\u1EA7n resources overhead \\u0111\\u1EC3 ch\\u1EA1y c\\xE1c services \\u0111\\xF3 (Spark, Livy, Zeppelin, Hive, HDFS, Monitoring, \\u2026).\"}),`\n`,(0,n.jsx)(e.li,{children:\"Chi ph\\xED qu\\u1EA3n l\\xFD EMR Cluster.\"}),`\n`,(0,n.jsx)(e.li,{children:\"HA tr\\xEAn EMR b\\u1EAFt bu\\u1ED9c b\\u1EA1n ph\\u1EA3i c\\xF3 3 node master ch\\u1EA1y song song, n\\u1EBFu 1 node master ch\\u1EBFt th\\xEC node kh\\xE1c l\\xEAn thay, nh\\u01B0ng b\\xECnh th\\u01B0\\u1EDDng s\\u1EBD l\\xE3ng ph\\xED 2 node backup kh\\xF4ng l\\xE0m g\\xEC c\\u1EA3.\"}),`\n`,(0,n.jsx)(e.li,{children:\"...\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[`Trong khi to\\xE0n b\\u1ED9 h\\u1EC7 th\\u1ED1ng Data Platform \\u0111\\u01B0\\u1EE3c thi\\u1EBFt k\\u1EBF d\\u01B0\\u1EDBi d\\u1EA1ng micro-services\nv\\xE0 `,(0,n.jsx)(e.em,{children:\"event-driven architecture\"}),` v\\u1EDBi nhi\\u1EC1u th\\xE0nh ph\\u1EA7n ch\\u1EA1y tr\\xEAn Kubernetes,\nteam b\\u1EAFt \\u0111\\u1EA7u ngh\\u0129 \\u0111\\u1EBFn vi\\u1EC7c deploy Spark Jobs tr\\xEAn Kubernetes thay v\\xEC EMR, c\\xF3 m\\u1ED9t s\\u1ED1 \\u01B0u \\u0111i\\u1EC3m c\\xF3 th\\u1EC3 k\\u1EC3 \\u0111\\u1EBFn:`]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Ti\\u1EBFt ki\\u1EC7m chi ph\\xED, bao g\\u1ED3m chi ph\\xED cho vi\\u1EC7c \\u0111\\u1EE3i provisioning v\\xE0 bootstrapping ph\\u1EE9c t\\u1EA1p, costing \\u0111\\u01B0\\u1EE3c t\\xEDnh theo gi\\xE2y, vi\\u1EC7c n\\xE0y c\\u0169ng gi\\xFAp lo\\u1EA1i b\\u1ECF chi ph\\xED qu\\u1EA3n l\\xFD EMR cluster, kho\\u1EA3ng \",(0,n.jsxs)(e.strong,{children:[(0,n.jsx)(e.span,{className:\"math math-inline\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mn,{children:\"700\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"700-\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7278em\",verticalAlign:\"-0.0833em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"700\"}),(0,n.jsx)(e.span,{className:\"mord\",children:\"\\u2212\"})]})})]})}),\"800\"]}),\" cho m\\u1ED9t th\\xE1ng (ch\\u01B0a bao g\\u1ED3m chi ph\\xED EC2).\"]}),`\n`,(0,n.jsx)(e.li,{children:\"Spark tr\\xEAn YARN c\\u0169ng t\\u1ED1n chi ph\\xED maintenance kh\\xF4ng nh\\u1ECF.\"}),`\n`,(0,n.jsx)(e.li,{children:\"Ti\\u1EBFt ki\\u1EC7m chi ph\\xED do kh\\xF4ng ph\\u1EA3i duy tr\\xEC m\\u1ED9t l\\xFAc 3 Node Master HA.\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"Kh\\xF4ng th\\u1EC3 ch\\u1EA1y nhi\\u1EC1u version c\\u1EE7a Spark kh\\xE1c nhau, v\\xED d\\u1EE5 \\u0111ang s\\u1EED d\\u1EE5ng Spark 2.4.x, b\\u1EA1n c\\u1EA7n upgrade m\\u1ED9t s\\u1ED1 Application l\\xEAn Spark 3.x \\u0111\\u1EC3 d\\xF9ng t\\xEDnh n\\u0103ng m\\u1EDBi, b\\u1EAFt bu\\u1ED9c ph\\u1EA3i upgrade c\\xE1c Application c\\u0169 ho\\u1EB7c c\\xE0i \\u0111\\u1EB7t m\\u1ED9t Cluster EMR m\\u1EDBi. Ng\\u01B0\\u1EE3c l\\u1EA1i Spark tr\\xEAn Kubernetes cho ph\\xE9p ch\\u1EA1y c\\xE1c driver, executer tr\\xEAn c\\xE1c Kubernetes Pod, m\\u1ED7i Pod g\\u1ED3m 1 container n\\xEAn c\\xF3 th\\u1EC3 isolated workloads d\\u1EC5 d\\xE0ng. Ngo\\xE0i ra c\\xF3 th\\u1EC3 th\\u1EEBa h\\u01B0\\u1EDFng \\u0111\\u01B0\\u1EE3c m\\u1ECDi t\\xEDnh n\\u0103ng c\\u1EE7a Kubernetes nh\\u01B0:\",`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/\",children:\"Request/Limit\"}),\": \\u0111i\\u1EC1u ch\\u1EC9nh hay gi\\u1EDBi h\\u1EA1n resources (mem, cpu), s\\u1ED1 l\\u01B0\\u1EE3ng Pod cho m\\u1ED7i Spark Application.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/\",children:\"Namespace\"}),\": Kubernetes Namespace c\\xF2n cho ph\\xE9p ph\\xE2n quy\\u1EC1n cho c\\xE1c team, c\\xE1c m\\xF4i tr\\u01B0\\u1EDDng v\\u1EDBi l\\u01B0\\u1EE3ng resources x\\xE1c \\u0111\\u1ECBnh n\\u1EEFa (e.g. namespace: \",(0,n.jsx)(e.code,{children:\"data-prod\"}),\", \",(0,n.jsx)(e.code,{children:\"data-stag\"}),\", \",(0,n.jsx)(e.code,{children:\"data-dev\"}),\", \\u2026)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"T\\u1EADn d\\u1EE5ng \\u0111\\u01B0\\u1EE3c \",(0,n.jsx)(e.a,{href:\"https://github.com/kubernetes/autoscaler\",children:\"Kubernetes Autoscaler\"}),\" v\\xE0 c\\xF3 kh\\u1EA3 n\\u0103ng scale-to-zero.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/\",children:\"Node Selector v\\xE0 Affinity\"}),\": cho ph\\xE9p ch\\u1ECDn lo\\u1EA1i Node t\\xF9y theo t\\xEDnh ch\\u1EA5t c\\u1EE7a Jobs \\u0111\\xF3, v\\xED d\\u1EE5 m\\u1ED9t s\\u1ED1 Jobs c\\u1EA7n nhi\\u1EC1u Mem, trong khi m\\u1ED9t kh\\u1ED1 Jobs kh\\xE1c c\\u1EA7n nhi\\u1EC1u CPU.\"]}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.h1,{id:\"2-spark-on-kubernetes---livy\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#2-spark-on-kubernetes---livy\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"2. Spark on Kubernetes - Livy\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"K\\u1EC3 t\\u1EEB 2.3.x l\\xE0 Spark \\u0111\\xE3 h\\u1ED7 tr\\u1EE3 ch\\u1EA1y tr\\xEAn cluster qu\\u1EA3n l\\xFD b\\u1EDFi Kubernetes. Ch\\xFAng ta c\\xF3 th\\u1EC3 submit m\\u1ED9t Spark Application b\\u1EA5t k\\u1EF3 tr\\u1EF1c ti\\u1EBFp b\\u1EB1ng c\\xE1ch s\\u1EED d\\u1EE5ng \",(0,n.jsx)(e.code,{children:\"spark-submit\"}),\" tr\\xEAn comand line, ch\\u1EC9 c\\u1EA7n thay \",(0,n.jsx)(e.code,{children:\"--master\"}),\" \\u0111\\u1EBFn \\u0111\\u1ECBa ch\\u1EC9 c\\u1EE7a Kubernetes \",(0,n.jsx)(e.code,{children:\"k8s://<api_server_host>:<k8s-apiserver-port>\"})]}),`\n`,(0,n.jsx)(e.p,{children:\"V\\xED d\\u1EE5 \\u0111\\u1EC3 ch\\u1EA1y Spark Pi tr\\xEAn Cluster mode, h\\xE3y xem v\\xED d\\u1EE5 sau:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"language-bash code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"$ bin/spark-submit \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"   --master k8s://https://\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\"k8s-apiserver-host\",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),\":\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\"k8s-apiserver-port\",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"   --deploy-mode cluster \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"   --name spark-pi \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"   --class org.apache.spark.examples.SparkPi \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"   --conf spark.executor.instances\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"   --conf spark.kubernetes.container.image\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\"spark-image\",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`   local:///path/to/examples.jar\n`})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Ch\\xFA \\xFD l\\xE0 \",(0,n.jsx)(e.code,{children:\"k8s://https://\"}),\" m\\xECnh kh\\xF4ng vi\\u1EBFt nh\\u1EA7m \\u0111\\xE2u nh\\xE9.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Nhu c\\u1EA7u \\u0111\\u1EC3 c\\xF3 th\\u1EC3 submit m\\u1ED9t lo\\u1EA1t jobs h\\xE0ng ng\\xE0y, team s\\u1EED d\\u1EE5ng \",(0,n.jsx)(e.strong,{children:(0,n.jsx)(e.a,{href:\"https://livy.incubator.apache.org/\",children:\"Apache Livy\"})}),\" tr\\xEAn Kubernetes, v\\u1EDBi ki\\u1EBFn tr\\xFAc nh\\u01B0 d\\u01B0\\u1EDBi \\u0111\\xE2y:\"]}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(t,{alt:\"\",src:\"/media/2022/03/spark-k8s-1.png\",width:\"1902\",height:\"1270\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Team s\\u1EED d\\u1EE5ng Livy, \\u0111\\xE2y l\\xE0 m\\u1ED9t service cho ph\\xE9p t\\u01B0\\u01A1ng t\\xE1c v\\u1EDBi Spark Cluster th\\xF4ng qua RESTful API. Livy \\u0111\\xE3 t\\u1EEBng \\u0111\\u01B0\\u1EE3c s\\u1EED d\\u1EE5ng tr\\xEAn EMR, \\u1EDF Kubernetes ch\\u1EC9 c\\u1EA7n deploy Livy th\\xF4ng qua Helm m\\u1ED9t c\\xE1ch d\\u1EC5 d\\xE0ng. Xem th\\xEAm c\\xE1ch c\\xE0i \\u0111\\u1EB7t Livy \\u1EDF \\u0111\\xE2y. \\u0110\\u1EC3 trigger Livy c\\xF3 nhi\\u1EC1u c\\xE1ch, team s\\u1EED d\\u1EE5ng Airflow nh\\u01B0 l\\xE0 m\\u1ED9t scheduler, c\\xF3 nhi\\u1EC1u lo\\u1EA1i DAGs t\\xF9y v\\xE0o t\\xEDnh ch\\u1EA5t c\\u1EE7a m\\u1ED7i Jobs, c\\xE1c DAG s\\u1EBD trigger Livy, theo d\\xF5i tr\\u1EA1ng th\\xE1i c\\u1EE7a Jobs \\u0111\\xF3 c\\u0169ng th\\xF4ng qua API, retry ho\\u1EB7c alert khi c\\u1EA7n thi\\u1EBFt. DAG c\\u0169ng c\\xF3 nhi\\u1EC7m v\\u1EE5 ki\\u1EC3m tra d\\u1EEF li\\u1EC7u (data validation) k\\u1EBFt qu\\u1EA3 \\u0111\\u1EA7u ra (output) cho m\\u1ED7i jobs.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Tuy nhi\\xEAn l\\u1EA1i c\\xF3 m\\u1ED9t s\\u1ED1 \\u0111i\\u1EC3m h\\u1EA1n ch\\u1EBF nh\\u01B0 do delay t\\u1EEB Airflow Scheduler, Livy c\\u0169ng d\\u1EC5 b\\u1ECB stuck. N\\u1EBFu m\\u1ED9t jobs ch\\u1EA1y l\\xE2u nh\\u01B0ng Livy b\\u1ECB restart th\\xEC Jobs \\u0111\\xF3 c\\u0169ng b\\u1ECB \\u1EA3nh h\\u01B0\\u1EDFng theo. Team quy\\u1EBFt \\u0111\\u1ECBnh n\\xE2ng c\\u1EA5p.\"}),`\n`,(0,n.jsxs)(e.h1,{id:\"3-spark-on-kubernetes---spark-operator\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#3-spark-on-kubernetes---spark-operator\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3. Spark on Kubernetes - Spark Operator\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Sau khi \\u0111\\xE1nh gi\\xE1 kh\\u1EA3 n\\u0103ng c\\u1EE7a Spark Operator b\\u1EDFi GCP Google, team quy\\u1EBFt \\u0111\\u1ECBnh \\u0111i \\u0111\\u1EBFn phi\\xEAn b\\u1EA3n 2.0 c\\u1EE7a architecture. C\\xE1c th\\xE0nh ph\\u1EA7n s\\u1EBD nh\\u01B0 h\\xECnh d\\u01B0\\u1EDBi \\u0111\\xE2y:\"}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(t,{alt:\"\",src:\"/media/2022/03/spark-k8s-2-operator.png\",width:\"1992\",height:\"1240\"})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u1EDE ki\\u1EBFn tr\\xFAc tr\\xEAn, vai tr\\xF2 c\\u1EE7a Data Engineer s\\u1EBD l\\xE0:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"(1) generate ra \",(0,n.jsx)(e.strong,{children:\"Spark Jobs Artifacts\"}),\" v\\xE0 commit/push v\\xE0o m\\u1ED9t Repo tr\\xEAn Git. Spark Jobs Artifacts s\\u1EBD c\\xF3 d\\u1EA1ng nh\\u01B0 v\\xED d\\u1EE5 n\\xE0y, c\\xF3 th\\u1EC3 hi\\u1EC3u \\u0111\\xE2y l\\xE0 m\\u1ED9t specs \\u0111\\u1EC3 Spark Operator c\\xF3 th\\u1EC3 submit v\\xE0 qu\\u1EA3n l\\xFD Jobs tr\\xEAn namespace c\\u1EE7a m\\xECnh. C\\xF3 2 lo\\u1EA1i CRDs c\\u1EE7a Spark Operator sinh ra \\u0111\\u1EC3 qu\\u1EA3n l\\xFD l\\xE0 \",(0,n.jsx)(e.code,{children:\"SparkApplication\"}),\" v\\xE0 \",(0,n.jsx)(e.code,{children:\"ScheduledSparkApplication\"}),\".\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"(2) \",(0,n.jsx)(e.strong,{children:\"Spark Submit Worker\"}),\" l\\xE0 m\\u1ED9t Pod ch\\u1EA1y tr\\xEAn Kubernetes, c\\xF3 nhi\\u1EC7m v\\u1EE5 \\u0111\\u1ECDc/sync nh\\u1EEFng g\\xEC tr\\xEAn Git v\\xE0 apply v\\xE0o Kubernetes th\\xF4ng qua Kubernetes API (ho\\u1EA1t \\u0111\\u1ED9ng gi\\u1ED1ng nh\\u01B0 \",(0,n.jsx)(e.code,{children:\"kubectl apply -f\"}),\").\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"(3) \",(0,n.jsx)(e.strong,{children:\"Spark Operator\"}),\" nh\\u01B0 m\\u1ECDi Operator kh\\xE1c, s\\u1EBD l\\u1EAFng nghe/\\u0111\\u1ECDc CRDs \\u0111\\u01B0\\u1EE3c submit v\\xE0o cluster, s\\u1EBD specify, running, v\\xE0 c\\u1EADp nh\\u1EADt status c\\u1EE7a c\\xE1c Spark application. T\\u1EEB m\\u1ED9t \",(0,n.jsx)(e.code,{children:\"SparkApplication\"}),\" Spark Operator s\\u1EBD d\\u1EF1ng m\\u1ED9t POD driver, POD driver s\\u1EBD request th\\xEAm t\\u1EEB Kubernetes \\u0111\\u1EC3 d\\u1EF1ng th\\xEAm c\\xE1c POD executor, \\u0111\\u1EBFn khi n\\xE0o Spark Jobs th\\u1EF1c hi\\u1EC7n xong s\\u1EBD t\\u1EF1 \\u0111\\u1ED9ng terminate c\\xE1c pod n\\xE0y. Logs s\\u1EBD \\u0111\\u01B0\\u1EE3c l\\u01B0u gi\\u1EEF \\u1EDF S3 bucket.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"(4) \",(0,n.jsx)(e.strong,{children:\"Spark History Server\"}),\" s\\u1EBD render logs t\\u1EEB S3 bucket, gi\\xFAp team engineer d\\u1EC5 d\\xE0ng h\\u01A1n trong vi\\u1EC7c traceback l\\u1EA1i c\\xE1c jobs c\\u0169 \\u0111\\xE3 finish.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"(5) \",(0,n.jsx)(e.strong,{children:\"Spark Jobs UI\"}),\" l\\xE0 m\\u1ED9t Web UI \\u0111\\u1EC3 qu\\u1EA3n l\\xFD t\\u1EA5t c\\u1EA3 c\\xE1c Spark Jobs tr\\xEAn Git, ki\\u1EC3m tra tr\\u1EA1ng th\\xE1i c\\u1EE7a m\\u1ED7i Jobs tr\\xEAn Cluster, monitor, data validation c\\u0169ng nh\\u01B0 backfill.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"H\\xE3y t\\xECm hi\\u1EC3u xem m\\u1ED9t s\\u1ED1 th\\xE0nh ph\\u1EA7n ch\\xEDnh \\u0111\\xF3ng vai tr\\xF2 g\\xEC nh\\xE9.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"31-spark-operator\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#31-spark-operator\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3.1. Spark Operator\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Spark Operator l\\xE0 m\\u1ED9t Kubernetes Operator \\u0111\\u01B0\\u1EE3c thi\\u1EBFt k\\u1EBF cho Spark nh\\u1EB1m m\\u1EE5c \\u0111\\xEDch x\\xE1c \\u0111\\u1ECBnh v\\xE0 th\\u1EF1c thi c\\xE1c Spark applications d\\u1EC5 d\\xE0ng nh\\u01B0 c\\xE1c workloads kh\\xE1c tr\\xEAn Kubernetes, b\\u1EB1ng c\\xE1ch s\\u1EED d\\u1EE5ng v\\xE0 qu\\u1EA3n l\\xFD m\\u1ED9t Kubernetes custom resources (CRD) \\u0111\\u1EC3 specifying, running, v\\xE0 update status c\\u1EE7a Spark applications.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u0110\\u1EC3 t\\xECm hi\\u1EC3u th\\xEAm b\\u1EA1n c\\xF3 th\\u1EC3 xem qua v\\u1EC1 \",(0,n.jsx)(e.a,{href:\"https://github.com/GoogleCloudPlatform/spark-on-k8s-operator/blob/master/docs/design.md\",children:\"Design\"}),\", \",(0,n.jsx)(e.a,{href:\"https://github.com/GoogleCloudPlatform/spark-on-k8s-operator/blob/master/docs/user-guide.md\",children:\"API Specification\"}),\", v\\xE0 \",(0,n.jsx)(e.a,{href:\"https://github.com/GoogleCloudPlatform/spark-on-k8s-operator/blob/master/docs/user-guide.md\",children:\"User Guide\"}),\" tr\\xEAn Github.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"V\\xED d\\u1EE5 \\u0111\\u1EC3 c\\xE0i \\u0111\\u1EB7t Spark Operator tr\\xEAn namespace \",(0,n.jsx)(e.code,{children:\"spark-jobs\"}),\" th\\xF4ng qua Helm chart, \\u1EDF \\u0111\\xE2y m\\xECnh b\\u1EADt t\\xEDnh n\\u0103ng \",(0,n.jsx)(e.code,{children:\"webhook\"}),\". T\\xF9y v\\xE0o h\\u1EC7 th\\u1ED1ng qu\\u1EA3n l\\xFD c\\u1EE7a b\\u1EA1n m\\xE0 c\\xF3 th\\u1EC3 c\\xE0i \\u0111\\u1EB7t th\\xF4ng quan FluxCD hay ArgoCD, \\u1EDF \\u0111\\xE2y m\\xECnh s\\u1EED d\\u1EE5ng \",(0,n.jsx)(e.code,{children:\"helm\"}),\" cli \\u0111\\u01A1n gi\\u1EA3n cho vi\\u1EC7c minh h\\u1ECDa:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"language-bash code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"helm repo \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),` spark-operator https://googlecloudplatform.github.io/spark-on-k8s-operator\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"helm \",(0,n.jsx)(e.span,{className:\"token function\",children:\"install\"}),\" spark-operator \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"   spark-operator/spark-operator \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"   --namespace spark-jobs \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"   --set \",(0,n.jsx)(e.span,{className:\"token assign-left variable\",children:\"sparkJobNamespace\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"spark-jobs \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"   --set webhook.enable\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`true\n`]})]})}),`\n`,(0,n.jsxs)(e.h2,{id:\"32-spark-submit-worker\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#32-spark-submit-worker\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3.2. Spark Submit Worker\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"M\\u1ED9t \",(0,n.jsx)(e.code,{children:\"SparkApplication\"}),\" c\\xF3 v\\u1EC1 c\\u01A1 b\\u1EA3n l\\xE0 m\\u1ED9t resource CRD, c\\xF3 th\\u1EC3 \\u0111\\u01B0\\u1EE3c apply v\\xE0o cluster b\\u1EB1ng \",(0,n.jsx)(e.code,{children:\"kubectl\"}),\", nh\\u01B0 v\\xED d\\u1EE5 d\\u01B0\\u1EDBi \\u0111\\xE2y:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"language-yaml code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# spark-pi.yaml\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"---\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"apiVersion\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'sparkoperator.k8s.io/v1beta2'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"kind\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` SparkApplication\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"metadata\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" pyspark\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`pi\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"namespace\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" spark\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`jobs\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"spec\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` Python\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"pythonVersion\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'3'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` cluster\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"image\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'gcr.io/spark-operator/spark-py:v3.1.1'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"imagePullPolicy\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` Always\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"mainApplicationFile\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" local\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`///opt/spark/examples/src/main/python/pi.py\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sparkVersion\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'3.1.1'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"restartPolicy\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` OnFailure\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"onFailureRetries\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"onFailureRetryInterval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"onSubmissionFailureRetries\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"onSubmissionFailureRetryInterval\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"20\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"driver\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"cores\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"coreLimit\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'1200m'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"memory\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'512m'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"labels\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"version\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 3.1.1\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"serviceAccount\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` spark\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"executor\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"cores\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"instances\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"memory\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'512m'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"labels\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"version\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` 3.1.1\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u0110\\u1EC3 submit SparkPi n\\xE0y v\\xE0o Kubernetes, b\\u1EA1n ch\\u1EC9 c\\u1EA7n s\\u1EED d\\u1EE5ng:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"language-bash code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`kubectl apply -f spark-pi.yaml\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`kubectl get sparkapp\n`})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u0110\\u1EC3 t\\u1EF1 \\u0111\\u1ED9ng h\\xF3a, \",(0,n.jsx)(e.strong,{children:\"Spark Submit Worker\"}),\" l\\xE0 m\\u1ED9t Cronjob Pod \\u0111\\u1EC3 \\u0111\\u1ECBnh k\\u1EF3 (~5ph) sync v\\u1EDBi Git Repo v\\xE0 apply m\\u1ECDi spark app d\\u01B0\\u1EDBi d\\u1EA1ng c\\xE1c file YAML v\\xE0 m\\u1ECDi thay \\u0111\\u1ED5i l\\xEAn cluster. C\\xF3 2 d\\u1EA1ng artifacts m\\xE0 Spark Submit qu\\u1EA3n l\\xFD l\\xE0 \",(0,n.jsx)(e.code,{children:\"SparkApplication\"}),\" v\\xE0 \",(0,n.jsx)(e.code,{children:\"ScheduledSparkApplication\"}),\" nh\\u01B0 \\u0111\\xE3 n\\xF3i \\u1EDF tr\\xEAn.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Vi\\u1EC7c qu\\u1EA3n l\\xFD c\\xE1c Spark Application d\\u01B0\\u1EDBi d\\u1EA1ng YAML specs c\\xF2n gi\\xFAp c\\xF3 th\\xEAm m\\u1ED9t s\\u1ED1 l\\u1EE3i \\xEDch c\\u1EE7a \",(0,n.jsx)(e.strong,{children:\"GitOps\"}),\": m\\u1ECDi thay \\u0111\\u1ED5i \\u0111\\u1EC1u \\u0111\\u01B0\\u1EE3c Git Versioning, ph\\xE2n quy\\u1EC1n tr\\xEAn Git, review thay \\u0111\\u1ED5i, approve ho\\u1EB7c reject thay \\u0111\\u1ED5i, d\\u1EC5 d\\xE0ng rollback b\\u1EB1ng c\\xE1ch revert git, \\u2026\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"33-spark-jobs-ui\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#33-spark-jobs-ui\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3.3. Spark Jobs UI\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Spark Jobs UI hay Spark Jobs Dashboard l\\xE0 m\\u1ED9t Web UI \\u0111\\u1EC3 qu\\u1EA3n l\\xFD Spark Jobs v\\xE0 artifacts \\u0111\\u01B0\\u1EE3c generated ho\\u1EB7c customized b\\u1EDFi engineers. Dashboard \\u0111\\u01B0\\u1EE3c vi\\u1EBFt b\\u1EB1ng Typescript v\\xE0 Next.js, g\\u1ED3m m\\u1ED9t s\\u1ED1 t\\xEDnh n\\u0103ng c\\u01A1 b\\u1EA3n nh\\u01B0:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Li\\u1EC7t k\\xEA m\\u1ECDi Spark Jobs artifacts\"}),`\n`,(0,n.jsx)(e.li,{children:\"Xem n\\u1ED9i dung c\\u1EE7a t\\u1EEBng Spark Application YAML files\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"Xem th\\xF4ng tin status c\\u1EE7a m\\u1ED7i Scheduled Spark Application nh\\u01B0 l\\xE0 \",(0,n.jsx)(e.code,{children:\"scheduleStatus\"}),\", \",(0,n.jsx)(e.code,{children:\"lastRun\"}),\", \",(0,n.jsx)(e.code,{children:\"nextRun\"}),\", ...\"]}),`\n`,(0,n.jsx)(e.li,{children:\"Ki\\u1EC3m tra nhanh d\\u1EEF li\\u1EC7u output (basic data validation) cho m\\u1ED7i jobs theo interval c\\u1EE7a Jobs \\u0111\\xF3. V\\xED d\\u1EE5 m\\u1ED9t jobs theo ng\\xE0y (daily), UI s\\u1EBD ki\\u1EC3m tra m\\u1ED7i ng\\xE0y xem c\\xF3 data c\\u1EE7a ng\\xE0y h\\xF4m \\u0111\\xF3 c\\xF3 h\\u1EE3p l\\u1EC7 kh\\xF4ng.\"}),`\n`,(0,n.jsx)(e.li,{children:\"Th\\u1ED1ng k\\xEA c\\u01A1 b\\u1EA3n nh\\u01B0 s\\u1ED1 Jobs \\u0111ang ch\\u1EA1y, \\u0111ang pending, s\\u1ED1 l\\u01B0\\u1EE3ng Jobs l\\u1ED7i, resources (CPU/Memory) s\\u1EED d\\u1EE5ng, \\u2026\"}),`\n`,(0,n.jsx)(e.li,{children:\"Backfill: c\\xF3 th\\u1EC3 trigger ch\\u1EA1y l\\u1EA1i cho m\\u1ED9t ho\\u1EB7c nhi\\u1EC1u jobs, m\\u1ED9t ng\\xE0y ho\\u1EB7c nhi\\u1EC1u ng\\xE0y.\"}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"H\\xE3y xem m\\u1ED9t s\\u1ED1 screenshot d\\u01B0\\u1EDBi \\u0111\\xE2y \\u0111\\u1EC3 c\\xF3 c\\xE1i h\\xECnh c\\u1EE5 th\\u1EC3 h\\u01A1n:\"}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(t,{alt:\"Fossil Spark UI\",src:\"/media/2022/03/spark-k8s-3.png\",width:\"2296\",height:\"1497\"})}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(t,{alt:\"Data Validation\",src:\"/media/2022/03/spark-k8s-4.png\",width:\"2296\",height:\"1521\"})}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(t,{alt:\"Backfill: trigger \\u0111\\u1EC3 ch\\u1EA1y l\\u1EA1i Jobs cho m\\u1ED9t ho\\u1EB7c m\\u1ED9t s\\u1ED1 ng\\xE0y c\\u1EE5 th\\u1EC3 trong qu\\xE1 kh\\u1EE9\",src:\"/media/2022/03/spark-k8s-5.png\",width:\"2296\",height:\"1521\"})}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(t,{alt:\"C\\xF3 th\\u1EC3 custom m\\u1ED9t s\\u1ED1 config l\\xFAc ch\\u1EA1y backfill, nh\\u01B0 resources, s\\u1ED1 l\\u01B0\\u1EE3ng executor, spark version, ...\",src:\"/media/2022/03/spark-k8s-6.png\",width:\"2296\",height:\"1521\"})}),`\n`,(0,n.jsxs)(e.h2,{id:\"34-spark-history-server\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#34-spark-history-server\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3.4. Spark History Server\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Spark History Server l\\xE0 m\\u1ED9t Spark Web UI c\\xF3 s\\u1EB5n c\\u1EE7a Spark, d\\xF9ng \\u0111\\u1EC3 monitor tr\\u1EA1ng th\\xE1i v\\xE0 t\\xE0i nguy\\xEAn s\\u1EED d\\u1EE5ng cho Spark App. Spark History Server \\u0111\\u01B0\\u1EE3c d\\u1EF1ng l\\xEAn \\u0111\\u1EC3 \\u0111\\u1ECDc l\\u1EA1i logs c\\u1EE7a c\\xE1c Jobs \\u0111\\xE3 ho\\xE0n th\\xE0nh tr\\u01B0\\u1EDBc \\u0111\\xF3 l\\u01B0u tr\\xEAn S3 bucket. M\\u1ED7i \",(0,n.jsx)(e.code,{children:\"SparkApplication\"}),\" s\\u1EBD \\u0111\\u01B0\\u1EE3c config \\u0111\\u1EC3 push Spark events l\\xEAn S3:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"language-yaml code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"spec\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"sparkConf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"'spark.eventLog.enabled'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'true'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"'spark.eventLog.dir'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'s3a://fossil-spark/logs/'\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Spark History Server c\\u0169ng c\\xF3 th\\u1EC3 \\u0111\\u01B0\\u1EE3c c\\xE0i \\u0111\\u1EB7t th\\xF4ng qua \",(0,n.jsx)(e.a,{href:\"https://artifacthub.io/packages/helm/spot/spark-history-server\",children:\"this Helm Chart\"}),\", ch\\u1EC9 c\\u1EA7n tr\\u1ECF \\u0111\\xFAng \\u0111\\u01B0\\u1EDDng d\\u1EABn c\\u1EE7a \",(0,n.jsx)(e.code,{children:\"logDirectory\"}),\" v\\xE0o \\u0111\\xFAng v\\u1ECB tr\\xED S3 bucket m\\xE0 Spark \\u0111\\xE3 g\\u1EEDi l\\xEAn.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"language-yaml code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"helm repo add stable https\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//kubernetes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`charts.storage.googleapis.com\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"helm install stable/spark\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"history\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`server \\\\\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"namespace spark\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`jobs \\\\\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`set enableS3=true \\\\\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\"set logDirectory=s3a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//fossil\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`spark/logs/\n`]})]})}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(t,{alt:\"Untitled\",src:\"/media/2022/03/spark-k8s-7.png\",width:\"1392\",height:\"984\"})}),`\n`,(0,n.jsxs)(e.h1,{id:\"4-performance-tuning-on-kubernetes\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#4-performance-tuning-on-kubernetes\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"4. Performance Tuning on Kubernetes\"]}),`\n`,(0,n.jsxs)(e.p,{children:[`C\\xF3 r\\u1EA5t nhi\\u1EC1u t\\u1ED1i \\u01B0u \\u0111\\u01B0\\u1EE3c \\u0111\\u01B0\\u1EE3c th\\u1EF1c hi\\u1EC7n do t\\xEDnh ch\\u1EA5t Spark tr\\xEAn Kubernetes + AWS s\\u1EBD c\\xF3 ch\\xFAt kh\\xE1c bi\\u1EC7t v\\u1EDBi Spark tr\\xEAn YARN.\nM\\u1ED9t s\\u1ED1 c\\xF3 th\\u1EC3 k\\u1EC3 \\u0111\\u1EBFn m\\xE0 b\\u1EA1n c\\xF3 th\\u1EC3 xem th\\xEAm \\u1EDF \\u0111\\xE2y\n`,(0,n.jsx)(e.a,{href:\"/2021/04/spark-kubernetes-performance-tuning.html\",children:\"Spark on Kubernetes Performance Tuning\"}),\" ho\\u1EB7c d\\u1EC5 d\\xE0ng t\\xECm ki\\u1EBFm tr\\xEAn Google:\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Using Volcano Scheduler for Gang schedule\"}),`\n`,(0,n.jsx)(e.li,{children:\"Using Kryo serialization\"}),`\n`,(0,n.jsx)(e.li,{children:\"Ignoring Data Locality because of S3 data source.\"}),`\n`,(0,n.jsx)(e.li,{children:\"I/O for S3\"}),`\n`,(0,n.jsx)(e.li,{children:\"Tuning Java\"}),`\n`,(0,n.jsx)(e.li,{children:\"Enabled Dynamic Allocation and Dynamic Allocation Shuffle File Tracking\"}),`\n`,(0,n.jsx)(e.li,{children:\"Using Kubernetes Node Spot instance for the executors.\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h1,{id:\"5-k\\u1EBFt\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#5-k\\u1EBFt\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"5. K\\u1EBFt\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Nh\\u01B0 v\\u1EADy l\\xE0 m\\u1ECDi ng\\u01B0\\u1EDDi \\u0111\\xE3 c\\xF3 th\\u1EC3 h\\xECnh dung \\u0111\\u01B0\\u1EE3c c\\xE1ch m\\xE0 team Data Platform t\\u1EA1i Fossil s\\u1EED d\\u1EE5ng v\\u1EADn h\\xE0nh Apache Spark tr\\xEAn Kubernetes.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Do c\\xF3 nhi\\u1EC1u chi ti\\u1EBFt, nhi\\u1EC1u v\\u1EA5n \\u0111\\u1EC1 k\\u1EF9 thu\\u1EADt, c\\xE1ch c\\xE0i \\u0111\\u1EB7t, c\\xE1ch t\\u1ED1i \\u01B0u, \\u2026 m\\xE0 m\\xECnh kh\\xF3 c\\xF3 th\\u1EC3 \\u0111\\u1EC1 c\\u1EADp h\\u1EBFt \\u0111\\u01B0\\u1EE3c, do \\u0111\\xF3 b\\xE0i vi\\u1EBFt ch\\u1EC9 d\\u1EEBng l\\u1EA1i \\u1EDF t\\xEDnh ch\\u1EA5t gi\\u1EDBi thi\\u1EC7u t\\u1ED5ng qu\\xE1t. M\\xECnh s\\u1EBD c\\u1ED1 g\\u1EAFng chi ti\\u1EBFt h\\xF3a c\\xE1c v\\u1EA5n \\u0111\\u1EC1 \\u1EDF c\\xE1c b\\xE0i vi\\u1EBFt kh\\xE1c n\\u1EBFu c\\xF3 th\\u1EC3 trong t\\u01B0\\u01A1ng lai.\"}),`\n`,(0,n.jsx)(\"div\",{class:\"bg-emerald-600 p-5\",children:(0,n.jsxs)(e.p,{children:[`B\\xE0i vi\\u1EBFt c\\u0169ng \\u0111\\u01B0\\u1EE3c \\u0111\\u0103ng t\\u1EA1i\n`,(0,n.jsx)(\"a\",{href:\"https://blog.duyet.net/2022/03/spark-kubernetes-at-fossil\",children:\"duyet.net\"}),\".\"]})}),`\n`,(0,n.jsx)(\"div\",{class:\"bg-blue-100 border-t border-b border-blue-500\",children:(0,n.jsxs)(e.p,{children:[`Hi\\u1EC7n t\\u1EA1i Fossil Cloud Data \\u0111ang open cho c\\xE1c v\\u1ECB tr\\xED (Sr) Data Engineer,\n`,(0,n.jsx)(\"a\",{href:\"https://sites.google.com/fossil.com/fossil-vietnam/careers/jobs\",target:\"_blank\",children:\"xem th\\xEAm JD t\\u1EA1i \\u0111\\xE2y\"}),`\nho\\u1EB7c g\\u1EEDi CV c\\u1EE7a b\\u1EA1n v\\u1EC1 email `,(0,n.jsx)(\"strong\",{children:\"lvduyet (at) fossil.com\"}),\" \\u0111\\u1EC3 c\\xF9ng trao \\u0111\\u1ED5i th\\xEAm nh\\xE9.\"]})}),`\n`,(0,n.jsxs)(e.h1,{id:\"6-references\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#6-references\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"6. References\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://kubernetes.io\",children:\"https://kubernetes.io\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://spark.apache.org\",children:\"https://spark.apache.org\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://airflow.apache.org\",children:\"https://airflow.apache.org\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://livy.incubator.apache.org\",children:\"https://livy.incubator.apache.org\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://github.com/GoogleCloudPlatform/spark-on-k8s-operator\",children:\"https://github.com/GoogleCloudPlatform/spark-on-k8s-operator\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://kubernetes.io/docs/concepts/extend-kubernetes/operator\",children:\"https://kubernetes.io/docs/concepts/extend-kubernetes/operator\"})}),`\n`]})]})}}var S=v;function f(a,c){throw new Error(\"Expected \"+(c?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return A;})();\n;return Component;","toc":[{"value":"1. Apache Spark trên AWS EMR","url":"#1-apache-spark-trên-aws-emr","depth":1},{"value":"2. Spark on Kubernetes - Livy","url":"#2-spark-on-kubernetes---livy","depth":1},{"value":"3. Spark on Kubernetes - Spark Operator","url":"#3-spark-on-kubernetes---spark-operator","depth":1},{"value":"3.1. Spark Operator","url":"#31-spark-operator","depth":2},{"value":"3.2. Spark Submit Worker","url":"#32-spark-submit-worker","depth":2},{"value":"3.3. Spark Jobs UI","url":"#33-spark-jobs-ui","depth":2},{"value":"3.4. Spark History Server","url":"#34-spark-history-server","depth":2},{"value":"4. Performance Tuning on Kubernetes","url":"#4-performance-tuning-on-kubernetes","depth":1},{"value":"5. Kết","url":"#5-kết","depth":1},{"value":"6. References","url":"#6-references","depth":1}],"frontMatter":{"readingTime":{"text":"14 min read","minutes":13.315,"time":798900,"words":2663},"slug":"spark-on-kubernetes-at-fossil","fileName":"2022-03-10-spark-on-kubernetes-at-fossil.md","title":"Spark on Kubernetes tại Fossil","authors":["duyet"],"date":"2022-03-10T00:00:00.000Z","tags":["engineering","data"],"summary":"Apache Spark được chọn làm công nghệ cho Batch layer bởi khả năng xử lý một lượng lớn data cùng một lúc. Ở thiết kế ban đầu, team data chọn sử dụng Apache Spark trên AWS EMR do có sẵn và triển khai nhanh chóng. Dần dần, AWS EMR bộc lộ một số điểm hạn chế trên môi trường Production. Trong bài viết này, mình sẽ nói về tại sao và làm thế nào team Data chuyển từ Spark trên AWS EMR sang Kubernetes.","layout":"PostLayout"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.475,"time":28500,"words":95},"slug":["duyet"],"fileName":"duyet.md","name":"Duyet Le","avatar":"https://avatars.githubusercontent.com/u/5009534?v=4","occupation":"Data Engineer","company":"Fossil Vietnam","email":"lvduyet@fossil.com","twitter":"https://twitter.com/_duyet","linkedin":"https://www.linkedin.com/in/duyet","github":"https://github.com/duyet","date":null}],"prev":{"title":"1,234 days — Day 1 at Fossil","authors":["nga"],"date":"2020-02-27T00:00:00.000Z","tags":["life"],"summary":"A thousand-ish more days later, I could definitely testify to the jaded Day 1 philosophy by Amazon CEO Jeff Bezos: Every day here has felt just like Day 1.","layout":"PostLayout","slug":"1234"},"next":null},"__N_SSG":true}