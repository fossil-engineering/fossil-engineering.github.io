{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var o=Object.create;var h=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var y=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports),k=(t,n)=>{for(var c in n)h(t,c,{get:n[c],enumerable:!0})},r=(t,n,c,s)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let i of u(n))!m.call(t,i)&&i!==c&&h(t,i,{get:()=>n[i],enumerable:!(s=g(n,i))||s.enumerable});return t};var b=(t,n,c)=>(c=t!=null?o(p(t)):{},r(n||!t||!t.__esModule?h(c,\"default\",{value:t,enumerable:!0}):c,t)),x=t=>r(h({},\"__esModule\",{value:!0}),t);var a=y((T,l)=>{l.exports=_jsx_runtime});var w={};k(w,{default:()=>f,frontmatter:()=>v});var e=b(a()),v={title:\"Tuning ElasticSearch storage\",authors:[\"khanh\"],date:\"2022-07-29\",tags:[\"engineering\",\"data\"],summary:\"Vi\\u1EC7c t\\u1ED1i \\u01B0u b\\u1ED9 nh\\u1EDB cho Database r\\u1EA5t quan tr\\u1ECDng \\u0111\\u1ED1i v\\u1EDBi 1 Data Engineer, sau \\u0111\\xE2y m\\xECnh s\\u1EBD chia s\\u1EBB nh\\u1EEFng c\\xE1ch m\\xE0 Fossil \\u0111\\xE3 s\\u1EED d\\u1EE5ng \\u0111\\u1EC3 t\\u1ED1i \\u01B0u b\\u1ED9 nh\\u1EDB cho ElasticSearch\",layout:\"PostLayout\"};function d(t){let n=Object.assign({p:\"p\",strong:\"strong\",pre:\"pre\",code:\"code\",a:\"a\",em:\"em\",h1:\"h1\"},t.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"Fossil \\u0111\\xE3 \\u0111i\\u1EC1u ch\\u1EC9nh v\\xE0 t\\u1ED1i \\u01B0u b\\u1ED9 nh\\u1EDB cho c\\u1EE5m Elasticsearch nh\\u01B0 th\\u1EBF n\\xE0o?\"})}),`\n`,(0,e.jsx)(n.p,{children:\"B\\u1ED1i c\\u1EA3nh\"}),`\n`,(0,e.jsx)(n.p,{children:\"Fossil Vi\\u1EC7t Nam l\\xE0 m\\u1ED9t trung t\\xE2m nghi\\xEAn c\\u1EE9u n\\xEAn logs l\\xE0 m\\u1ED9t ph\\u1EA7n r\\u1EA5t quan tr\\u1ECDng. Ch\\xEDnh v\\xEC v\\u1EADy logs c\\u1EA7n \\u0111\\u01B0\\u1EE3c truy xu\\u1EA5t nhanh \\u0111\\u1EC3 \\u0111\\xE1p \\u1EE9ng nh\\u1EEFng nhu c\\u1EA7u nh\\u01B0 debug hardware, QA test c\\u0169ng nh\\u01B0 CS team c\\xF3 th\\u1EC3 ki\\u1EC3m tra log \\u0111\\u1EC3 gi\\xFAp \\u0111\\u1EE1 user trong l\\xFAc s\\u1EED d\\u1EE5ng app, ... Tr\\u01B0\\u1EDBc \\u0111\\xE2y, logs sau khi ETL th\\xEC \\u0111\\u01B0\\u1EE3c l\\u01B0u \\u1EDF S3 v\\xE0 sau \\u0111\\xF3 s\\u1EED d\\u1EE5ng Athena \\u0111\\u1EC3 truy xu\\u1EA5t, v\\u1EA5n \\u0111\\u1EC1 xu\\u1EA5t hi\\u1EC7n khi d\\xF9ng Athena truy xu\\u1EA5t c\\xE0ng nhi\\u1EC1u th\\xEC s\\u1EBD t\\u1ED1n chi ph\\xED query, c\\xF9ng v\\u1EDBi \\u0111\\xF3 v\\u1EDBi l\\u01B0\\u1EE3ng d\\u1EEF li\\u1EC7u l\\u1EDBn Athena th\\u01B0\\u1EDDng cho k\\u1EBFt qu\\u1EA3 kh\\xE1 l\\xE2u. V\\u1EDBi nh\\u1EEFng y\\xEAu c\\u1EA7u \\u0111\\xF3 m\\xECnh l\\u1EF1a ch\\u1ECDn Elasticsearch (ES) \\u0111\\u1EC3 l\\u01B0u tr\\u1EEF v\\xE0 tr\\xEDch xu\\u1EA5t log.\"}),`\n`,(0,e.jsx)(n.p,{children:\"ES kh\\xF4ng c\\xF2n qu\\xE1 xa l\\u1EA1 \\u0111\\u1EB7c bi\\u1EC7t l\\xE0 \\u0111\\u1ED1i v\\u1EDBi c\\xE1c Data Engineer trong b\\xE0i n\\xE0y m\\xECnh s\\u1EBD kh\\xF4ng n\\xF3i \\u0111\\u1EBFn vi\\u1EC7c ES l\\xE0m vi\\u1EC7c nh\\u01B0 th\\u1EBF n\\xE0o m\\xE0 m\\xECnh s\\u1EBD \\u0111\\u1EC1 c\\u1EADp \\u0111\\u1EBFn m\\u1ED9t v\\u1EA5n \\u0111\\u1EC1 khi c\\xE0i \\u0111\\u1EB7t ES tr\\xEAn k8s m\\xE0 m\\xECnh \\u0111\\xE3 g\\u1EB7p ph\\u1EA3i \\u0111\\xF3 l\\xE0 tunning storage cho es cluster. Ch\\xFAng ta \\u0111\\xE3 bi\\u1EBFt v\\xEC es s\\u1EBD index d\\u1EEF li\\u1EC7u c\\u1EE7a ch\\xFAng ta \\u0111\\u1EC3 t\\u0103ng t\\u1ED1c \\u0111\\u1ED9 truy xu\\u1EA5t cho n\\xEAn k\\xEDch th\\u01B0\\u1EDBc s\\u1EBD t\\u0103ng \\u0111\\xE1ng k\\u1EC3 so v\\u1EDBi d\\u1EEF li\\u1EC7u \\u0111\\u01B0\\u1EE3c l\\u01B0u \\u1EDF c\\xE1c storage kh\\xE1c nh\\u01B0 S3 hay GCS v\\xE0 k\\xEDch th\\u01B0\\u1EDBc \\u1EDF \\u0111\\xE2y l\\u1EA1i ch\\xEDnh l\\xE0 \\u0111\\u0129a \\u1EDF k8s cho n\\xEAn ch\\xFAng ta s\\u1EBD ph\\u1EA3i c\\xE2n \\u0111\\u1ED1i c\\xE1c config \\u0111\\u1EC3 v\\u1EEBa \\u0111\\xE1p \\u1EE9ng v\\u1EDBi nhu c\\u1EA7u v\\xE0 t\\u1ED1c \\u0111\\u1ED9 truy xu\\u1EA5t d\\u1EEF li\\u1EC7u. V\\u1EDBi Fossil, d\\u1EEF li\\u1EC7u \\u1EDF d\\u1EA1ng json, nhu c\\u1EA7u search ch\\xEDnh x\\xE1c gi\\xE1 tr\\u1ECB \\u0111\\u1ED1i v\\u1EDBi m\\u1ED9t s\\u1ED1 fields v\\xED d\\u1EE5 nh\\u01B0 (userid, testid, ...).\"}),`\n`,(0,e.jsx)(n.p,{children:\"Khi kh\\xF4ng s\\u1EED d\\u1EE5ng template\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-bash\",children:`GET localhost:9200/_cat/indices?v=true&s=index\n\nindex                       pri rep docs.count store.size pri.store.size\nsdk_log-2022-03-14            1   1     324105    202.2mb        202.2mb\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"V\\xE0 d\\u01B0\\u1EDBi \\u0111\\xE2y l\\xE0 d\\u1EABn ch\\u1EE9ng cho ta th\\u1EA5y t\\u1EA7m quan tr\\u1ECDng c\\u1EE7a ES template\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u0110\\u1EA7u ti\\xEAn ch\\xFAng ta thay \\u0111\\u1ED5i \",(0,e.jsx)(n.strong,{children:\"compression type.\"}),\" M\\u1EB7c \\u0111\\u1ECBnh ES l\\xE0 LZ4 s\\u1EBD \\u0111\\u01B0\\u1EE3c \\xE1p d\\u1EE5ng, ch\\xFAng ta c\\xF3 th\\u1EC3 \\xE1p d\\u1EE5ng \",(0,e.jsx)(n.code,{children:\"best_compression\"}),\" s\\u1EED d\\u1EE5ng DEFLATE gi\\xFAp t\\u1EC9 l\\u1EC7 n\\xE9n cao h\\u01A1n nh\\u01B0ng s\\u1EBD d\\u1EABn t\\u1EDBi vi\\u1EC7c th\\u1EDDi gian n\\xE9n l\\xE2u h\\u01A1n. Tuy nhi\\xEAn \\u0111i\\u1EC1u n\\xE0y c\\xF3 th\\u1EC3 ch\\u1EA5p nh\\u1EADn \\u0111\\u01B0\\u1EE3c trong b\\u1ED1i c\\u1EA3nh ch\\xFAng ta \\u0111ang c\\u1EA7n \\u01B0u ti\\xEAn t\\u1ED1i \\u01B0u b\\u1ED9 nh\\u1EDB ...\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-bash\",children:`PUT localhost:9200/_template/sdk_log\n\n{\n    \"index_patterns\": [\n        \"sdk_log-*\"\n    ],\n    \"settings\": {\n        \"codec\": \"best_compression\",\n        \"merge.policy.max_merged_segment\": \"5mb\"\n    }\n}\n`})}),`\n`,(0,e.jsxs)(n.p,{children:[\"~13% b\\u1ED9 nh\\u1EDB \\u0111\\u01B0\\u1EE3c thu nh\\u1ECF khi d\\xF9ng \",(0,e.jsx)(n.code,{children:\"best_compression\"})]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-bash\",children:`GET localhost:9200/_cat/indices?v=true&s=index\n\nindex                                pri rep docs.count store.size pri.store.size\nsdk_log_best_compression-2022-03-14    1   1     324105    175.4mb        175.4mb\n\n`})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Ti\\u1EBFp theo ta c\\u1EA7n \\u0111i s\\xE2u m\\u1ED9t ch\\xFAt t\\xECm hi\\u1EC3u kh\\xE1i ni\\u1EC7m \",(0,e.jsx)(n.strong,{children:\"Mapping\"}),\". Mapping l\\xE0 m\\u1ED9t quy tr\\xECnh \\u0111\\u1EC3 \\u0111\\u1ECBnh ngh\\u0129a m\\u1ED9t b\\u1EA3n ghi v\\xE0 c\\xE1ch m\\xE0 c\\xE1c fields s\\u1EBD \\u0111\\u01B0\\u1EE3c qu\\u1EA3n l\\xFD, l\\u01B0u tr\\u1EEF v\\xE0 l\\u1EADp ch\\u1EC9 m\\u1EE5c. V\\xEC v\\u1EADy v\\u1EDBi m\\u1ED7i mapping kh\\xE1c nhau s\\u1EBD d\\u1EABn \\u0111\\u1EBFn kh\\xF4ng gian l\\u01B0u tr\\u1EEF v\\xE0 hi\\u1EC7u su\\u1EA5t kh\\xE1c nhau.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Sau \\u0111\\xE2y l\\xE0 3 tham s\\u1ED1 m\\xECnh \\u0111\\xE3 d\\xF9ng \\u0111\\u1EC3 t\\u1ED1i \\u01B0u b\\u1ED9 nh\\u1EDB.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"Field data types\"})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-types.html#mapping-types\",children:\"https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-types.html#mapping-types\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"M\\u1ED7i field s\\u1EBD c\\xF3 m\\u1ED9t \",(0,e.jsx)(n.em,{children:\"field data type\"}),\" n\\xF3 ch\\u1EC9 ra lo\\u1EA1i d\\u1EEF li\\u1EC7u c\\u1EE7a field \\u0111\\xF3. Ki\\u1EC3u d\\u1EEF li\\u1EC7u ch\\xFAng ta d\\xF9ng nhi\\u1EC1u nh\\u1EA5t v\\u1EDBi ES l\\xE0 ki\\u1EC3u chu\\u1ED7i (string) n\\xEAn ch\\xFAng ta c\\u1EA7n hi\\u1EC3u r\\xF5 hai lo\\u1EA1i \",(0,e.jsx)(n.strong,{children:\"text\"}),\" v\\xE0 \",(0,e.jsx)(n.strong,{children:\"keyword\"}),\". V\\u1EDBi text field d\\u1EEF li\\u1EC7u s\\u1EBD \\u0111\\u01B0\\u1EE3c ph\\xE2n t\\xEDch \\u0111\\u1EC3 \\u0111\\xE1p \\u1EE9ng nhu c\\u1EA7u full-text search trong khi v\\u1EDBi keyword d\\u1EEF li\\u1EC7u \\u0111\\u01B0\\u1EE3c gi\\u1EEF nguy\\xEAn \\u0111\\u1EC3 \\u0111\\xE1p \\u1EE9ng vi\\u1EC7c s\\u1EAFp x\\u1EBFp v\\xE0 l\\u1ECDc d\\u1EEF li\\u1EC7u. V\\u1EADy n\\xEAn t\\xF9y v\\xE0o nhu c\\u1EA7u truy xu\\u1EA5t b\\u1EA1n h\\xE3y ch\\u1ECDn ki\\u1EC3u d\\u1EEF li\\u1EC7u cho c\\xE1c field m\\u1ED9t c\\xE1ch h\\u1EE3p l\\xFD, theo m\\xECnh h\\u1EA1n ch\\u1EBF d\\xF9ng text file nh\\u1EEFng field cho nhu c\\u1EA7u t\\xECm ki\\u1EBFm g\\u1EA7n \\u0111\\xFAng nh\\u01B0 title, content, \\u2026 ta n\\xEAn d\\xF9ng text field, c\\xF2n l\\u1EA1i nh\\u1EEFng field y\\xEAu c\\u1EA7u t\\xECm ki\\u1EBFm ch\\xEDnh x\\xE1c match 100% ch\\xFAng ta s\\u1EBD d\\xF9ng keyword.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"C\\xE1c field types \\u0111\\u01B0\\u1EE3c nh\\xF3m l\\u1EA1i theo \",(0,e.jsx)(n.em,{children:\"family\"}),\". C\\xE1c lo\\u1EA1i d\\u1EEF li\\u1EC7u c\\xF9ng \",(0,e.jsx)(n.em,{children:\"family\"}),\" s\\u1EBD c\\xF3 ph\\u01B0\\u01A1ng th\\u1EE9c truy xu\\u1EA5t ho\\xE0n to\\xE0n gi\\u1ED1ng nhau nh\\u01B0ng s\\u1EBD c\\xF3 s\\u1EF1 kh\\xE1c nhau v\\u1EC1 kh\\xF4ng gian l\\u01B0u tr\\u1EEF v\\xE0 hi\\u1EC7u su\\u1EA5t.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"V\\xED d\\u1EE5 ch\\xFAng ta config ki\\u1EC3u d\\u1EEF li\\u1EC7u cho tr\\u01B0\\u1EDDng d\\u1EEF li\\u1EC7u brand.\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-bash\",children:`PUT localhost:9200/_template/sdk_log\n\n{\n    \"index_patterns\": [\n        \"sdk_log-*\"\n    ],\n    \"settings\": {\n        \"codec\": \"best_compression\",\n        \"merge.policy.max_merged_segment\": \"5mb\"\n    },\n    \"mappings\": {\n        \"properties\": {\n            },\n            \"brand\": {\n                \"type\": \"text\"\n            },\n        }\n    }\n}\n`})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"doc_values\"})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://www.elastic.co/guide/en/elasticsearch/reference/8.1/doc-values.html\",children:\"https://www.elastic.co/guide/en/elasticsearch/reference/8.1/doc-values.html\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Doc values l\\xE0 m\\u1ED9t ki\\u1EC3u d\\u1EEF li\\u1EC7u tr\\xEAn \\u0111\\u0129a (the on-disk data structure). Ph\\u1EA7n l\\u1EDBn c\\xE1c fields s\\u1EBD \\u0111\\u01B0\\u1EE3c m\\u1EB7c \\u0111\\u1ECBnh l\\u1EADp ch\\u1EC9 m\\u1EE5c (indexed) gi\\xFAp ch\\xFAng c\\xF3 th\\u1EC3 t\\xECm ki\\u1EBFm (searchable). \",(0,e.jsx)(n.a,{href:\"https://www.elastic.co/guide/en/elasticsearch/reference/8.1/number.html\",children:\"Numeric types\"}),\", \",(0,e.jsx)(n.a,{href:\"https://www.elastic.co/guide/en/elasticsearch/reference/8.1/date.html\",children:\"date types\"}),\", \",(0,e.jsx)(n.a,{href:\"https://www.elastic.co/guide/en/elasticsearch/reference/8.1/boolean.html\",children:\"boolean type\"}),\", \",(0,e.jsx)(n.a,{href:\"https://www.elastic.co/guide/en/elasticsearch/reference/8.1/ip.html\",children:\"ip type\"}),\", \",(0,e.jsx)(n.a,{href:\"https://www.elastic.co/guide/en/elasticsearch/reference/8.1/geo-point.html\",children:\"geo_point type\"}),\" v\\xE0 \",(0,e.jsx)(n.a,{href:\"https://www.elastic.co/guide/en/elasticsearch/reference/8.1/keyword.html\",children:\"keyword type\"}),\" v\\u1EABn c\\xF3 th\\u1EC3 truy xu\\u1EA5t khi ch\\xFAng kh\\xF4ng \\u0111\\u01B0\\u1EE3c \",(0,e.jsx)(n.a,{href:\"https://www.elastic.co/guide/en/elasticsearch/reference/8.1/mapping-index.html\",children:\"indexed\"}),\" m\\xE0 ch\\u1EC9 c\\xF3 doc values \\u0111\\u01B0\\u1EE3c b\\u1EADt \\u0111\\xF3 l\\xE0 kh\\xE1i ni\\u1EC7m \",(0,e.jsx)(n.strong,{children:\"doc-value-only fileds\"}),\". Hi\\u1EC7u su\\u1EA5t truy xu\\u1EA5t s\\u1EBD ch\\u1EADm h\\u01A1n nh\\u01B0ng ch\\xFAng ta c\\xF3 th\\u1EC3 \\u0111\\xE1nh \\u0111\\u1ED5i v\\u1EDBi kh\\xF4ng gian l\\u01B0u tr\\u1EEF tr\\xEAn \\u0111\\u0129a trong c\\xE1c tr\\u01B0\\u1EDDng h\\u1EE3p field \\u0111\\xF3 \\xEDt khi \\u0111\\u01B0\\u1EE3c truy su\\u1EA5t ho\\u1EB7c t\\u1ED1c \\u0111\\u1ED9 truy xu\\u1EA5t kh\\xF4ng quan tr\\u1ECDng. \\u1EDE Fossil, ngay c\\u1EA3 khi t\\u1ED1c \\u0111\\u1ED9 truy xu\\u1EA5t b\\u1ECB \\u0111\\xE1nh \\u0111\\u1ED5i c\\u01A1 b\\u1EA3n n\\xF3 v\\u1EABn nhanh h\\u01A1n r\\u1EA5t nhi\\u1EC1u so v\\u1EDBi Athena.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Doc-value-only field c\\xF3 th\\u1EC3 config nh\\u01B0 sau:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-bash\",children:`PUT localhost:9200/\\\\_template/sdk_log\n{\n    \"index_patterns\": [\n        \"sdk_log-*\"\n    ],\n    \"settings\": {\n        \"codec\": \"best_compression\",\n        \"merge.policy.max_merged_segment\": \"5mb\"\n    },\n    \"mappings\": {\n        \"properties\": {},\n        \"brand\": {\n            \"type\": \"text\",\n            \"index\": \"false\"\n        },\n    }\n}\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"Th\\u1EADm ch\\xED n\\u1EBFu b\\u1EA1n kh\\xF4ng c\\u1EA7n t\\u1ED5ng h\\u1EE3p, s\\u1EAFp x\\u1EBFp hay thay \\u0111\\u1ED5i gi\\xE1 tr\\u1ECB c\\u1EE7a m\\u1ED9t tr\\u01B0\\u1EDDng d\\u1EEF li\\u1EC7u ch\\xFAng ta c\\xF3 ho\\xE0n to\\xE0n c\\xF3 th\\u1EC3 t\\u1EAFt doc values \\u0111\\u1EC3 t\\u1ED1i \\u01B0u b\\u1ED9 nh\\u1EDB.\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-bash\",children:`PUT localhost:9200/\\\\_template/sdk_log\n{\n    \"index_patterns\": [\n        \"sdk_log-*\"\n    ],\n    \"settings\": {\n        \"codec\": \"best_compression\",\n        \"merge.policy.max_merged_segment\": \"5mb\"\n    },\n    \"mappings\": {\n        \"properties\": {},\n        \"brand\": {\n            \"type\": \"text\",\n            \"index\": \"false\",\n            \"doc_values\": \"false\"\n        },\n    }\n}\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"V\\xE0 ch\\xFAng ta xem b\\u1ED9 nh\\u1EDB \\u0111\\xE3 gi\\u1EA3m nh\\u01B0 th\\u1EBF n\\xE0o:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-bash\",children:`GET localhost:9200/_cat/indices?v=true&s=index\n\nindex                                pri rep docs.count store.size pri.store.size\nsdk_log-disable_doc_values-2022-03-14  1   1     324105     82.9mb         82.9mb\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"~60% dung l\\u01B0\\u1EE3ng b\\u1ED9 nh\\u1EDB \\u0111\\u01B0\\u1EE3c t\\u1ED1i \\u01B0u\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"norms\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Norms l\\u01B0u tr\\u1EEF c\\xE1c y\\u1EBFu t\\u1ED1 chu\\u1EA9n h\\xF3a kh\\xE1c nhau gi\\xFAp \\xEDch cho vi\\u1EC7c t\\u1EA1i th\\u1EDDi \\u0111i\\u1EC3m truy v\\u1EA5n c\\xF3 th\\u1EC3 t\\xEDnh \\u0111i\\u1EC3m d\\u1EEF li\\u1EC7u khi truy v\\u1EA5n. M\\u1EB7c d\\xF9 h\\u1EEFu \\xEDch cho vi\\u1EC7c t\\xEDnh \\u0111i\\u1EC3m, \\u0111\\xE1p \\u1EE9ng nhu c\\u1EA7u cho vi\\u1EC7c t\\xECm ki\\u1EBFm g\\u1EA7n \\u0111\\xFAng nh\\u01B0ng norms c\\u1EA7n kh\\xE1 nhi\\u1EC1u kh\\xF4ng gian tr\\xEAn \\u0111\\u0129a. V\\xEC v\\u1EADy \\u0111\\u1ED1i v\\u1EDBi nh\\u1EEFng tr\\u01B0\\u1EDDng kh\\xF4ng c\\xF3 nhu c\\u1EA7u tr\\xEAn ch\\xFAng ta c\\xF3 th\\u1EC3 t\\u1EAFt norms nh\\u01B0 sau:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-bash\",children:`PUT localhost:9200/\\\\_template/sdk_log\n{\n    \"index_patterns\": [\n        \"sdk_log-*\"\n    ],\n    \"settings\": {\n        \"codec\": \"best_compression\",\n        \"merge.policy.max_merged_segment\": \"5mb\"\n    },\n    \"mappings\": {\n        \"properties\": {},\n        \"brand\": {\n            \"type\": \"text\",\n            \"index\": \"false\",\n            \"doc_values\": \"false\"\n            \"norms\": \"false\"\n        },\n    }\n}\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"Th\\xEAm kho\\u1EA3ng ~1% b\\u1ED9 nh\\u1EDB \\u0111\\u01B0\\u1EE3c t\\u1ED1i \\u01B0u:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"language-bash\",children:`GET localhost:9200/_cat/indices?v=true&s=index\n\nindex                                pri rep docs.count store.size pri.store.size\nsdk_log-disable_doc_values-2022-03-14  1   1     324105       80mb         80mb\n`})}),`\n`,(0,e.jsx)(n.h1,{children:\"References\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://www.elastic.co/guide/index.html\",children:\"https://www.elastic.co/guide/index.html\"})})]})}function _(t={}){let{wrapper:n}=t.components||{};return n?(0,e.jsx)(n,Object.assign({},t,{children:(0,e.jsx)(d,t)})):d(t)}var f=_;return x(w);})();\n;return Component;","toc":[],"frontMatter":{"readingTime":{"text":"6 min read","minutes":5.99,"time":359400,"words":1198},"slug":"tuning-es-storage","fileName":"2022-07-29-tuning-es-storage.md","title":"Tuning ElasticSearch storage","authors":["khanh"],"date":"2022-07-29T00:00:00.000Z","tags":["engineering","data"],"summary":"Việc tối ưu bộ nhớ cho Database rất quan trọng đối với 1 Data Engineer, sau đây mình sẽ chia sẻ những cách mà Fossil đã sử dụng để tối ưu bộ nhớ cho ElasticSearch","layout":"PostLayout"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.18,"time":10800,"words":36},"slug":["khanh"],"fileName":"khanh.md","name":"Vu Duy Khanh","avatar":"https://avatars.githubusercontent.com/u/32119373?v=4","occupation":"Data Engineer","company":"Fossil Vietnam","email":"vdkhanh@fossil.com","linkedin":"https://www.linkedin.com/in/kh%C3%A1nh-v%C5%A9-duy-a1a3b1135/","github":"https://github.com/DuyKhanhVu","date":null}],"prev":{"title":"Apache Spark behind the scenes","authors":["hung"],"date":"2022-07-12T00:00:00.000Z","tags":["engineering","data"],"summary":"Các bạn có thắc mắc sau khi submit 1 job cho Spark Cluster thì Spark sẽ làm những gì không? Cùng tìm hiểu với mình nhé.","layout":"PostLayout","slug":"apache-spark-behind-the-scienes"},"next":null},"__N_SSG":true}